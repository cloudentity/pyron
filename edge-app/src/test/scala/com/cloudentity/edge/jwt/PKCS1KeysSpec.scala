package com.cloudentity.edge.jwt

import org.junit.runner.RunWith
import org.scalatest.{MustMatchers, WordSpec}
import org.scalatest.junit.JUnitRunner

@RunWith(classOf[JUnitRunner])
class PKCS1KeysSpec extends WordSpec with MustMatchers {
  "Rsa" should {
    "read private key" in {
      val key = """LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLVxuTUlJRXBBSUJBQUtDQVFFQXlZZE13aWtQOFRWT0hzR2MxQnhDVFZzY1AxRnBDdjZYTzFSd3MybFJMeGZLSHBKSFxuZ2YxQzlEQndMekVKdFArbXhWeGhVdzdlbnh2NGpyM2JtTmZUbTBWR2hmcng3anBxeUh6czQ0bCtXWmlOTGhXcVxuSmttOWdtY210KzVzenhXS3ZNWlIzUDdHM2pQd0crSHNVTjFZRVo1aEJ2N1BXdyswc0JEOWcwQUhOZnhIOGkrY1xuSjhTUHFjdW90aW9BcVovVHlBR3BVQVBaeDA4WXNKVXhQdHZMdEFDZUFXT3Y5M053MWRvdm1Mc0FRalBYOFh1ZFxuSFhUdnEyS1lVc3JGU3p1RXE4UXR4emdtbVhueW9jbDU1ZXJyamgyeVRXYWhFQk1IZlo1R09uUDFteUNqZE0zS1xuaFlKTDNJdjRqQUYvYlZ2dlNhSGt4ci9rWWgrRWVLVGVyOEx4SVFJREFRQUJBb0lCQUhBYlJQYnBjc1hpdWs5Zlxuc3dkSHBSWjFMWlNIakNDaW1heFdmODgrTWZ3NWhxVlZDRlJtZDUxeGFLYkg1N2Q1VStPTVRWT3YvT1dUNE1RL1xuRjI3QitTUHgrSlpGajluUFEyRytKT1U2c2ovVEhnNVozT29wc1ROZWdHcG5ScjQ0SkpKNDNFZE1yNElpY0ZxQ1xuWmp4aHRVRXYwcGZhbmF6eFlybGk2alBlSldUQXNaUHhTMWxmazY4b1BpeW1oSFl1eE41bUw2OFlQT2V5WlZJalxuNmhPR0x1SUtRUTA3Z3hiSWFTdThYMTNrcmp5Zk9UNVQrNTJjK0Y1UWtQdnRHeEpHRU5tWGgzSDJiVzdhM2MzUVxuSE5BMENGeDd1YS9qNzNsK1d4VUQzZHBDc2pxOGVXb25kbDA3UCtsbHpjN0c5N1c3bnI3OEgwcmJCaDRWMERRUlxuRkU4OHpiVUNnWUVBKzh3QXZuemRLRzE5MFgwOWp2b1QzM0h4UDFJcWw0QkhmRlRHS0pGS3RSWnpSazVjQ3ZaM1xueG5LeUcyTld5NG5idDdjTnIvZzdsbnpmUHpJNytFQzBnelVRMVlXV2tZaUxpaGZNT2xrNDE3Qng3d1kvaXBPTlxudVlsdzFuYy9Qa21LNHNPRWxBdTQ2OEJxSWI0Y1pBOEpJSTNQL0M3NWVSWDc1bmVud3NNN2kzTUNnWUVBek9SOFxuaFJMZktvUzQzOUZvYW92bXpCejMxRnZDMUtvNkhOZkhyR0RNL1d0R0dxSUMvSm5SM1RZWml2RHlySDNpRXM0dFxuVnJJTHFCSlFOSDEzQXJGK3JVSXpuekltRElzQmt0NmxqM3hKVGtySEdSL040TTYxQWZzQ25oWG9KdS9aSmdXdFxuU1Vvc1lJL1FhdnBURk9PbmdwNUhpZWJZNXJHWm5wRURyZE1BMUJzQ2dZRUFzYXNSdjFkVnFlZ1FSbGdycm80d1xucFpLOW1tTjg0Q2ZJeVNiOEo3WFZWQS9DU1JLVGlieTlhUTZYTkJJVk5VdFIrTUMyYkxzb09KaGw0aTZzK0ErWVxuRDVqTEJ3N2EzbGZOdGlQeW5CMUdxWks3NGQrenlERXphSDVkVzBjTEhnVkFkWjltRmh4cllCWUdEVWNhdTFPTVxucWliR1lmZzNXY1EwV1R1RzZUdGU4WmNDZ1lCZ2hzZ3UvVHdMME9rejhIakxzVXN6SC9hVm9nRkFwVTJwWnZMWFxuditiekFNWFBLRUpWOUxXTkRMNnQyV1BLWmFmTENqMEwyZWRwNys2L085aUVlVkJmbVkrdVVUYmhzOTh5N1JkOFxuYUtZMGIwQXJFdk93RkZIc00vQUF2L3RWMUtzdG9ZRUl4UnZ4QmUrL1psMGJ1MENnWmFiNFRid2p1c25QalN2NVxuaVMyYnZ3S0JnUURWT0ZVL25iOHhkVHpTbDA3dzZudDBNTk9xSHJCYXd5dUJsSFF0eFNDMFNwU3FweVNQMzVPd1xuaU4rVVY2eXVUdUdQSmtVQlo1ZkRzN1UvMTI4V2ZOYWkvZmVZVGV4Y2ZRZmNyeXVqQUxDVFJ1UWdoRzkvZXloUVxuOEZqODBZeGhtNERtKzRIVGN6bTFnc0xEU1cxT3JzQW02d1E3WUhDQlhGQURzdENtWlJlUkd3PT1cbi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0t"""
      val result = PKCS1Keys.readBase64PrivateKey(key)
      result.isSuccess must be (true)
    }
  }
}
